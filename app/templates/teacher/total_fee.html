{% extends "share/dashboard.html" %}

{% block title %}Generate Total Fee{% endblock %}
{% block card_header %}bg-info{% endblock %}
{% block card_title %}Total Fee Overview{% endblock %}

{% block card_content %}
<div class="container mt-4">
    <h4>Total Fee Report</h4>

    <!-- Dropdown to filter by class -->
    <form method="GET" action="{{ url_for('teacher.generate_total_fee') }}" class="mb-4">
        <div class="row align-items-center">
            <div class="col-md-6">
                <label for="class_name" class="form-label">Select Class:</label>
                <select id="class_name" name="class_name" class="form-select">
                    <option value="">All Classes</option>
                    {% for class_name in class_names %}
                        <option value="{{ class_name }}" {% if selected_class == class_name %}selected{% endif %}>{{ class_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-6 d-flex align-items-end">
                <button type="submit" class="btn btn-primary">Filter</button>
            </div>
        </div>
    </form>

    <!-- Total Fee Summary -->
    <h5>Total Fee for {{ selected_class if selected_class else "All Classes" }}: 
        <strong>RM {{ "{:,.2f}".format(total_fee or 0) }}</strong>
    </h5>

    <!-- Table to display students and their fees -->
    <table class="table table-bordered mt-4">
        <thead>
            <tr>
                <th>Student Name</th>
                <th>Class</th>
                <th>Total Fee (RM)</th>
            </tr>
        </thead>
        <tbody>
            {% if students %}
                {% for student in students %}
                    <tr>
                        <td>{{ student.name }}</td>
                        <td>{{ student.class_name }}</td>
                        <td>{{ "{:,.2f}".format(student.total_fee) }}</td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="3" class="text-center">No records found.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
